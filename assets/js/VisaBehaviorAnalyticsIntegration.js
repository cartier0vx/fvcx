function tryNoCatch(n){try{n()}catch(t){}}function submitForm(n){$(n).data("formSubmitted")!==!0&&(tryNoCatch(function(){$("[type=hidden][name="+clickedSubmitButton.name+"][value="+clickedSubmitButton.value+"]").remove();$("<input />").attr("type","hidden").attr("name",clickedSubmitButton.name).attr("value",clickedSubmitButton.value).attr("data-clickedSubmit","clicked").appendTo(n)}),tryNoCatch(function(){typeof vbaTimeoutId!="undefined"&&vbaTimeoutId!==null&&clearTimeout(vbaTimeoutId)}),tryNoCatch(function(){formDefaultPrevented===!0&&$(n).unbind("submit")}),n.submit(),$(n).data("formSubmitted",!0),tryNoCatch(function(){formDefaultPrevented=!1;clickedSubmitButton=null;vbaTimeoutId=null;$("[data-clickedSubmit=clicked]").remove()}))}function addVBAToken(n){$("<input>").attr({type:"hidden",id:"v-c-vaap-token",name:"v-c-vaap-token",value:n}).appendTo(formToSubmit);submitForm(formToSubmit)}var staticVars={get jqueryLoaded(){return typeof jQuery!="undefined"&&$===jQuery?!0:!1},get jqueryValidationLoaded(){return staticVars.jqueryLoaded&&$.validator?!0:!1}},input,vbaSubmitHandler,initVbaSubmit;staticVars.jqueryLoaded===!1&&(input=document.createElement("input"),input.setAttribute("type","hidden"),input.setAttribute("name","vba-cl-err"),input.setAttribute("value","NoJquery"),document.querySelector("form").appendChild(input));var clickedSubmitButton=null,formToSubmit=null,vbaTimeoutId=null,formDefaultPrevented=!1;$(function(){$(document).on("click","button:not([type]),[type=submit]",function(n){$(n.target)[0].name!==undefined&&$(n.target)[0].value!==undefined&&(clickedSubmitButton=$(n.target)[0])})});vbaSubmitHandler=function(n){formToSubmit=n;$("*#v-c-vaap-token").remove();vbaTimeoutId=setTimeout(function(){$("<input>").attr({type:"hidden",id:"vba-cl-err",name:"vba-cl-err",value:"ClientSideTimeout"}).appendTo(formToSubmit);submitForm(formToSubmit)},2e4);try{VAAP.getToken(addVBAToken)}catch(t){tryNoCatch(function(){typeof vbaTimeoutId!="undefined"&&vbaTimeoutId!==null&&clearTimeout(vbaTimeoutId)});$("<input>").attr({type:"hidden",id:"vba-cl-err",name:"vba-cl-err",value:"VBAInternalSDKError:"+t.toString()}).appendTo(formToSubmit);submitForm(formToSubmit)}};initVbaSubmit=function(n){var t=[];t=n!==undefined&&n!==""&&n.length>0?n:$("form");t.each(function(n,t){try{if(staticVars.jqueryValidationLoaded&&typeof $(t).validate=="function")$.extend($(t).validate().settings,{submitHandler:function(n){return vbaSubmitHandler(n),!1}});else $(t).on("submit",function(n){n.preventDefault(n);formDefaultPrevented=!0;vbaSubmitHandler($(t))})}catch(i){$("<input>").attr({type:"hidden",id:"vba-cl-err",name:"vba-cl-err",value:"Form:"+n+t.id+",AddSubmitHandlerError:"+i.toString()}).appendTo(t)}})};$(document).ready(function(){initVbaSubmit()})